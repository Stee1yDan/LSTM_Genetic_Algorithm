import requests
import pandas as pd
from datetime import datetime

VTBR_monthly_url = "https://export.finam.ru/export9.out?apply=0&p=10&e=.csv&dtf=2&tmf=1&MSOR=0&mstimever=on&sep=3&sep2=1&datf=1&at=1&from=01.01.2024&to=01.04.2024&em=19043&code=VTBR&f=VTBR_240101_240401&cn=VTBR&market=undefined&yf={from_year}&yt={to_year}&df={from_day}&dt={to_day}&mf={from_month}&mt={to_month}&token=03AFcWeA79zvsJSRFT-w-jRzUjMVEVKAWmHt1UhjBsTOX2El-NJBkcvFPlGnmbkrv9wl93wL8myp5uaDinOanx6pG09P5r2McxHb1LGU_jE74pQHQM-_2Vo8RnSR9MTku7akki9DwFqKXA9A3zqodtrrfIUi0qzIO5FCUyHqmKw5j0xITmUabZk0xUhAXQ3m7QX3DXOiFRloi-jnl3KiVhgYckIeLhASJ8BTdJgvQM1ybJQcDcJYiLaN6vTRjrNjyBCvq1HCT2HE4DSW8_HiEQd4G81b4XWS5J7F7rrLHCx3zULWYMM0sLsjbWezWczHQ_wAg1PhDIp3KoEQGsqyU0cknIJWGeRqImMqXA2GIXprNM1_L6360XN249x3i6gEwb7pLOiimuZoinpvB-2nc0tYf1NtXp9OHtXitDKeZJoHNH5iKn3LIp5wqU8kgR_QB1d6EOn-1D_1GHDwfPoCsxkXJLeqdgDWS3Urzy8lZR_S4hk9izxCO-DEGwRf8xVskr6t6jptL_3d7qcC6jcMuhSWXZCunwooc4FrzG6igUqZZJ8vfuVTUPUGJ5rhzx871HFIqqVd3lSyydnYeFOMKb5XLwo0rzar-yZqPLb2ocbM_ZDNQpt-lho7TJEONbwkoq6wt1X4tuXD_lJTfvvtZEl0SHXLHBiqRDUVE0BqeJIi9YBGn5C6CNulg"
LKOH_monthly_url = "https://export.finam.ru/export9.out?apply=0&p=10&e=.csv&dtf=2&tmf=1&MSOR=0&mstimever=on&sep=3&sep2=1&datf=1&at=1&from=01.01.2024&to=01.04.2024&em=8&code=LKOH&f=LKOH_240101_240401&cn=LKOH&market=undefined&yf={from_year}&yt={to_year}&df={from_day}&dt={to_day}&mf={from_month}&mt={to_month}&token=03AFcWeA69L2MFvW15vaaDI7cccPcYM5R5Ki4gC9oqRRMmwAYONBaUCCVgh6eA5q4M02b3B7ZlmpLX4I4Td0S2RQISsVDqqhtx7L5n10Rt789FyEi_7J8BnYQOAIC6RaoDsLIO6oHR1cRdGrIYe4EcT5Ldu5lvyd318pPwwS20VaKLzy2V4mW7-Z4O2zSHZ1iC93qq9mz8P-1weEMRVLxMJsKQOJKT5keUeXdLUX479BubPKKtI1ejkrpyBZLbTOUJiTdF6turxeH3UZZa7ktyfEWCo1Jhj6pDDKFRmajBQhuh1c_LLjEz0SgQAY3-M_6zXw2qr0Ugql7FCblIh0RLx2QblwWXo5rksyt6I0wUI98t8tNwvNJlkxv7tXxzD12zE1BlD-2Eg2x3dQZtEcS3RuM3Dl2_KkGAYSIvenC_6Fhyx-GDBcnUcya1GSZ6Wy9VmRvaltuZ8U1IUc-tommOolj2a_6HItPnqah6gUGib7KM8g0_QNmh6A0oHmg4xKRELCEsSYiVeK9vpCkL9vX-SGM-75AThzPzbjSWfW50WqwoPN_aU6rpR-GIJp_rXqjjHMwK1xj3Rs26OS5cb-OKRBSxT_TFqwdUrQKmsivyS5Bn8avxsvA481aSnQc-L4fut2Y3jexd5i-fRJk0c79mrW-fGEeyIzxTVTqhmP7pBx8QWHuo9p4RMgc"
ASTR_monthly_url = "https://export.finam.ru/export9.out?apply=0&p=10&e=.csv&dtf=2&tmf=1&MSOR=0&mstimever=on&sep=3&sep2=1&datf=1&at=1&from=01.01.2024&to=01.04.2024&em=4577624&code=ASTR&f=ASTR_240101_240401&cn=ASTR&market=undefined&yf={from_year}&yt={to_year}&df={from_day}&dt={to_day}&mf={from_month}&mt={to_month}&token=03AFcWeA49aJc1Avz3KrFzU1Vrp_DBnYxchnArZVhoS-tKoVkFf_w6oi5_PBC5sPxsPdXWidwsMxI5p9iA7Xo5n9EzWYLk8yHzYT7Zk2kn_4qY8vAZ1gIcLrt8AY1b1f77qbS1DLJIg9_1lS3UrgMruehpdDoS8GHlrcmwL_Ih_EsAWJLLOc0Tzb5kUM-gdKP3QL8UWMhBVNBPlwnUBhyelmqIkX3m7VIn0POkGXgNqtIkv6DARpSP9bfFZZTtwxi1Y11SG-kfSCy4NKBRm4hPSqsMSskDfKsjZbeLWESW_lr43snSfV1TfSp2ZKi_JRsejlynWILwE_1G8-1rsG8iYUNKVLcRbefbd6dy6U9VhCCnDqxzmmO8edFEISrKo0Ao26QRbIXCZrVFFHCfkG6Jm7gy1nnHPugCKVdpFv6hqHbpDrFtIXBfCK2497y2K37Rnc7f9Rr4ADq9PimnQZI7e5DNN1W1WJqzAZNRv8bMbCyfUBz_0sOWNXvolz6Oe_nqka-LAwMLv--4pNq4txdLdVqoLnRx_rOMfvxnEY6l2nK58wgICdJyoQuyp8smoYchQrJ8N0oxj6ZRU2T8EVSHJyjMk-xCBCRIDbnUn7Dh_4O2HaBy3A1Nx5f_EOlZFdHEcc00mvmr6pJaIZkWBrcYQO3YWGwDef998PMGkwsLMeYh9tUPIU10yVU"
GMKN_monthly_url = "https://export.finam.ru/export9.out?apply=0&p=10&e=.csv&dtf=2&tmf=1&MSOR=0&mstimever=on&sep=3&sep2=1&datf=1&at=1&from=01.01.2024&to=01.04.2024&em=795&code=GMKN&f=GMKN_240101_240401&cn=GMKN&market=undefined&yf={from_year}&yt={to_year}&df={from_day}&dt={to_day}&mf={from_month}&mt={to_month}&token=03AFcWeA5_mk2f2k8k_XLvV9WYCJ-pBFDF0sE4T6URTrQPfIL-BdbG_1wdwqWYkMQqCCfTUJEcia-SAwf1agq15_XcrnFmwgqUK7rEW5AeWj_8kHH48Qtj4gAVV8Tln60N2jKeebcUmFH681M_DLrnd1A2pbore60nORFtthYxPr0Js0R-BmL1RGdka9n725UPRYOh8rBW-q5cZSX5LjWeSHN7xELef6HVvtnjaDfV2iTVH7POXsn0nrQ1VvXNb0yi6FgOjG6z0E93T6QUUV28aC9Uba1VAFwSSDiG4zlRv3kIqdbRn4iF7f2gWYgGwnuS3CWT0NMLCc-YpEPBgDc5J6x_xqN2jaMY7X3uy3jfxeBWYr6ldueKPt1d0utYjnxVCIAMlhzXYv97oyrPBSLTmXOZkuRmWCQ77Uaf5nB7IL15NokGaz5mvO7fFOOzF236v7BKkYx71d5eetn49zJIMU_SgT6BPEmZpVtnaNFbzxo9DlxjghlspfLaoT8yX7Yn1oq8_EnEnUx9ASlo1z81uDILlYn0ZJiGL7A0L06PMNE52IGEvFrSiRg2-udYqnzp99HMl48qMmDnPR5b2BQzRLCfcv8jqoeyMdsSNHee8JXTu3Vn8IF4xXCcIakiLmg9cUWCjxtTzwRbHrXDoVW0joDB-6U_NqLwK2uJsp9I68WTG02-9bjFCqw"
MGNT_monthly_url = "https://export.finam.ru/export9.out?apply=0&p=10&e=.csv&dtf=2&tmf=1&MSOR=0&mstimever=on&sep=3&sep2=1&datf=1&at=1&from=01.01.2024&to=01.04.2024&em=17086&code=MGNT&f=MGNT_240101_240401&cn=MGNT&market=undefined&yf={from_year}&yt={to_year}&df={from_day}&dt={to_day}&mf={from_month}&mt={to_month}&token=03AFcWeA7Vsru3atwmOmjoYmkBmcsDo-Acwgvc-1G4JzsXWStPkNgKEd0FnednIUKmAfAX2h0XgkimVhoPzPbnSWIg90HF0nzNXJ16dyElM00Tpe3BQ90X2DSCp6lqyEAR9fhvr5SfbMCRGk12a_L0FkVRfYLrMYM1XDe_-h7xZ0oSyffNlKPGeyHvk1RxEUAyERRW1_1YRPYQ-yQtNrJI-mPEKML1v7j4lecvyTjL5tiiXYm26r7FizVJOs7fNkRfckfoZzKzYt2_2EqhdGL6FDyiHhQbCedsD9ohVdCYRf7JOXXcW5sb579pNAeymfd4zwLVvPiami5mnnsgOGzSUuJ8Ug2U5qX2MypxfN6BoSMSEBfrIeWd7v2JdqDIYu6dtd3HNPQEx0NX1gYeqEVzpUDHglLGMO03es9VrzEoBa4YcuMNTcKpeYncBr3BWVSjR7WscoU8buaId_-IIqD1qOk4ksgOfySx1Z_1KwI0In1dzkK0-_34inuDX-xt6TBCnlEldeP8oMe3PxDfo091TTia-qLEXaTdhqCljmH-Z0cWvLyha0h3KUND5RPQbUdGc-ZxVyUkQeNIReY7IW8kkSdM5kHMfTn6UZBaxBsOk9LQafMMPkefXBcEYw666rDSkWqgL-90tge7x9BWmV-A_pQvioq9ohnDyKwYzDIHGlNZEhz5z_cyhZY"
PLZL_monthly_url = "https://export.finam.ru/export9.out?apply=0&p=10&e=.csv&dtf=2&tmf=1&MSOR=0&mstimever=on&sep=3&sep2=1&datf=1&at=1&from=01.01.2024&to=01.04.2024&em=17123&code=PLZL&f=PLZL_240101_240401&cn=PLZL&market=undefined&yf={from_year}&yt={to_year}&df={from_day}&dt={to_day}&mf={from_month}&mt={to_month}&token=03AFcWeA6TBeIscVOxpb7s4laC_LHj4tGOUdmW4h9zvCsaFbWV_LNZSQkLKnSG5LVC6kpYXrUe0tI1DyQFHbsEgUHQBbveUtTHAnC3knlf0ySGTe1NEi23xgT195A5hT3E1hwkIxta6D1ip9TwnlacjaAD7tIOMp4p_bEJvOb4f3G9Bmfa6UwWJ-CrTpMWybpdtWIW-n1uE8hUkDNSwN2tSqRXB5gn3H5KLoLgWUOeELgvVWrNmKtN5HkKGTvENYeeiTdJ25PVuZTycI6yNR4LTkGLiY_ClFk6UmojGbTDtuQnsSkDp8WalsO5UdjESx3o729SDdY_pB0bKTIYWrU_fM-97kUI7Agd7MQdu5HYdLSE7NjH_Iecd7J2tF4ZqxLXHSxRcKslwlxGcAuDA2WG0W5TY2nl1pInURNRK0wNXeeeKR6hQE-4Ugh6ltYTwCGaTHl2rJLJsutzC7MqWmyJ5ijcymQJ6oAwbEMzs1nlXyTw_m2dypLqtoZk3XSIH86QUx6BchbLGjo1H_YYaw8k-VmPnUy-E_d9e1EfT5_8LftRl7iV9wE734_C16W4QqnVNTfhQBGs6LlWRuMd95Au-RVvKkIWCDO_4QxHkNSU8y0z1p6qFB7KB1fcVA4cQfuAFVNNCKPeAeEuYYxuKOrkVxrdMjfxIXIvgBizkf6F3iwtPcAMv8J33m0"
GAZP_monthly_url = "https://export.finam.ru/export9.out?apply=0&p=10&e=.csv&dtf=2&tmf=1&MSOR=0&mstimever=on&sep=3&sep2=1&datf=1&at=1&from=01.01.2024&to=01.04.2024&em=16842&code=GAZP&f=GAZP_240101_240401&cn=GAZP&market=undefined&yf={from_year}&yt={to_year}&df={from_day}&dt={to_day}&mf={from_month}&mt={to_month}&token=03AFcWeA7znr_mT5oNBtdCuGkZEqZoPS6NUIJCSnt8CSFPyJay_DxmTdRg-YxgRxfIzVXz464ZY3au66ng--HfJ1CWGQTRAJlWyZ_mGjZa-G4eiUpTewpfLFi0w7LhyC9JgIXkzyme_NDzw78OAEcAi3DmKVLVzsxORCCb3tpeYCa498181vFLlytQXn6I4GgCUqH_FPKlS_Oaacw70M51m21IxV8hgYeM6dRBOox1ow9y_6KYafjic194m7BsRBjl3jSUrANnreXoFHOFw7vfUefUszX7WAXlQkpYF3gnU5hqCNDI3halkw3RVNt8P6do_lhot823kXnOzTheSpnuakzCyULVncsawbd9HeMolqOANr0JJXGHDspQUYdcGBVR0clwGcSRrYt0tQhoBqvY8ooEWe4wRdXa5uz_rb-ECnuL_v7Tq8zAdh1gtA3-KC41DMFa4VuiOcyxM5efIOTGV__ZtVwrXrjWhZwJkF5m9jGcgKhIGphZfInDcMGELHBUCbxb1wu6K9Qbmzdx4Kw5kxcazRStDVKzsiV_-Fw2AarKwEV563sXXuGn45jMtaiccMPa4TpLXZDn4VGrksO7rFfMUzBSIFReq-EgS1Oa6kgXrYsiuQYabjXsPTD6vYNr_OzMq7vFv1uG6CMLLZJX3ASFU7lN0lJmxg3sbVdAOEdz_gwxCQ5iPxM"
SBER_monthly_url = "https://export.finam.ru/export9.out?apply=0&p=10&e=.csv&dtf=2&tmf=1&MSOR=0&mstimever=on&sep=3&sep2=1&datf=1&at=1&from=01.01.2024&to=01.04.2024&em=3&code=SBER&f=SBER_240101_240401&cn=SBER&market=undefined&yf={from_year}&yt={to_year}&df={from_day}&dt={to_day}&mf={from_month}&mt={to_month}&token=03AFcWeA6vWGx4zy3sSYKhNFov4p60wlWhjgDc04MJM2DOwazugxGrDmLECJJgypXLysZPOZhbWTO2_eLn8O0Tbu69lvEyPMy_Grj8u6qBdCCUoC52ZdNVxTallo_mcA0r_5rrvly36YQLsr-FpOp9rvcPL1e3qG6JGPvS3UxOqeIVEd8pOYgrer54DG6BRZHGYA1SEZMdnA_MtUxrzYxnImQbqS8O2uNQHfohgb5zGO4mRvk1HAxPPI3X3t96s1TOy3UApaF_Vc-WPc_3QHGlsj4PiDWMyf4WbjFyZ0J_Rl7BkEIt-bCFs9ck_3uI6xF-Un4XtB1kqdAynOiT0EpeJE93c0iAA7UBfzjrVMFfedUztwk4HYifcqXZPXcq_Hx5haRmk2wA3M9ZhMyh28QXjpoh6W8uvCH60EB77KawFsPldy84hpW-QjhGGrma36uszSkZSmzT2Oqe1REFzPVWFmooUu4e70GSCaoS4tVyM_NwSrmbQX5HKaBeFeVrjJ3L9hQl18GmJePpF9Sy91x0vd9iwgn-ZFmhLbExuLc7at3U1tdgT_-wOiIwwcH-dqarkj3QPB5zEZpiyHxOyThiothVBmbaVv0bd2pteXgOeN_lVFLnsYy-gdc0F1aOPEyaaZcf6l9IdmDpf7hYUuLxNjgiXPMqS0dSpUzbtvzZi2Zkm36Cwz728n4"
NVTK_monthly_url = "https://export.finam.ru/export9.out?apply=0&p=10&e=.csv&dtf=2&tmf=1&MSOR=0&mstimever=on&sep=3&sep2=1&datf=1&at=1&from=01.01.2024&to=01.04.2024&em=17370&code=NVTK&f=NVTK_240101_240401&cn=NVTK&market=undefined&yf={from_year}&yt={to_year}&df={from_day}&dt={to_day}&mf={from_month}&mt={to_month}&token=03AFcWeA4exViYPEWMooA92xWV0qE4M31kSzo4RMcaFkZ4jfymKdC7AzHgm8Hj3p8OrWhxW7HSqT2Fna4VV6hwiMwrRsWdF057bdXBoTqUeVQSOEnDgtp7Kew7i65o6Np3LAeBJkY9z1mvrYziQ1mzJjTvtQy8IKfGp3zgSX8NMdxkeODsonH587eP6p5pr2teM0XB7XWlDRcoW6aRizJ3JjjWagI34IvJfwGotCHjLQa1pUgmVh3-cF8WKbWQitXlXAeCds9e6ZPvHNU9RqFnFY79aNecQP51nlZ9Gn5ii2S4QVRlTo8lt85HgiMAKJAeZxLVAXgCLsE4QzvZiSXZp0pCyoge7zk_idfNB_QY4vjXwgxha0nUTLoXm9bTo_XxKJhN1fAhT3-idFbYCMvm5SGySymVLWdOdSwUrty1NUhAOC5-2CgOAZa9wDQsW_kc0plU0dedW91uowG5pBxeKkAE1sjxqms0VEQN4jMO7o7Ldl-wPrjAFJ_xaCTZRtfJB3FqHCLekAPLAmNDX9tUHy6rdTv5wF6hR_IRE-4ywocmIRltnFZpY1EAPZy7BRXxL9s_aVdBxxNXND19dPD7s36J1bYjFkfqnSdzdK2d4LJWaQ295M8peaxQ3W6MbP8fEbQubS8UXx9s5GT0QFOIU2vbxIJkfq1QW3U1RrkstMURY3W0-2ynhh4"
YNDX_monthly_url = "https://export.finam.ru/export9.out?apply=0&p=10&e=.csv&dtf=2&tmf=1&MSOR=0&mstimever=on&sep=3&sep2=1&datf=1&at=1&from=01.01.2024&to=01.04.2024&em=388383&code=YNDX&f=YNDX_240101_240401&cn=YNDX&market=undefined&yf={from_year}&yt={to_year}&df={from_day}&dt={to_day}&mf={from_month}&mt={to_month}&token=03AFcWeA61zA-ujw2CIOAyHl4o0WvjcQom79e_O3DTPSuEqHHlEQyX6mqFFc3OF6kdNndryWWR0i1dDgZfV80_6zWci5Taj1LBq4mLMA9P19Xc8Hak-QhI20s6aBdq5FaBUFgHphMisGP-qHVLGgKKc6X8hj4fb-QDfocdpu5Q5xzdfD4RK6hQBoByt35lqjvsvZpR6irs_mAyLbmX2pMPN4cfC62r5V1gG34fwJVqQ3Rh71SdqRkmZ_P5xPOxT_9hVHruWgU5mhFpDxZIqcwBT0ZWLZxCsy78mVonjGxiqnyAh_09cVS2CXxS_z2UXvmxrwNt21w64ZVRqeayfFTeyRZlP18nQNLMMfEPi_JUvfg-O7jBuL1P6_YSazebjkU4WcI87Ye16Pn1nCqN7Fj1_a8BlaWpB_ob62uj2z9e_WDxZyHFP32M7yttjKmHctTbVfaDbMBgX6mGUEHRRDnh98reToX6j3Wgh8N80eO53ELFn688m6PuL-cqiiJ9Bz9jGH7W-Hjlwkl41nrUEegsWequKhqcGP8oyzNs2BecAFyEVNDzz3sifUrM666tYVgBYn9E3w51UUCQyeZlkknXiX0BdDsvNqJU6d1DqHbnB2SZpnUguZs7C0LjXEuxHhrRhTRu_zqd3-iXaodYvNViq9oWWmNrAX7_GQ"

VTBR_daily_url = "https://export.finam.ru/export9.out?apply=0&p=8&e=.csv&dtf=2&tmf=1&MSOR=0&mstimever=on&sep=3&sep2=1&datf=1&at=1&from=30.04.2020&to=30.04.2024&em=19043&code=VTBR&f=VTBR_200430_240430&cn=VTBR&market=undefined&yf={from_year}&yt={to_year}&df={from_day}&dt={to_day}&mf={from_month}&mt={to_month}&token=03AFcWeA5oE3wIdSUzyFrlhY5F0yrwoBTUsV-yX7XhR0RSUwTE526eFUFkb62k7fuCTuOgP5QQqg_tZ1ABvvb4A2XW9wWZSZ7t45lIgx1hmQtqjt-FrP4SqFkEU8eu6ctVIWIzTq4eOWtxTTwuOWYnUncyM7p0fc03jH414JGybbM9euM-1QX2E7ApRU6-O_MlcbRrhOGiu67eynYDyXsn-Kn6fG9vlwvAZShV2rxcNLz56GLXIiomI7eh9N1rvfWsq9ecHsfJ42pr-eAYWgp8yKuPgPYEj1KdKX0wXSKN6hKdA09Pyd_0nUootiUqTBWs-lmxqUqlgT54m_rz-i0Xe3ItvgSJWCnJvdOVvSVQif-zBjl43MVJKnZ1-PIQ29ER0fHUA3xSQFuOL2kV--RZ3Iej4JEvHRQFuPt0hTEJjkkx4k65dtzVwZQ3jD4GCysqf5_SHt7PqJEUtpHZ84BlJmUygtegyZ01xKWur-nLuz17gUGQpqUz8EIBq5DUW8AcvGwztwcvvfeul7rgWDtjTkPluuq-pdJCA6QeE3MBmj7sXMLaeLqBJ7tUPTUMrjZPQCA5MmZcBZ1WHM0ajpj9aSzPBHSBTNBXOwSzr4thgtCzcghIrcWSbNzwK02WILgkWESpm5YalPyV66FiFF2YJIa01jew57Vejsa7qB16aMK1Wh0Ytf90JUE"
LKOH_daily_url = "https://export.finam.ru/export9.out?apply=0&p=8&e=.csv&dtf=2&tmf=1&MSOR=0&mstimever=on&sep=3&sep2=1&datf=1&at=1&from=30.04.2020&to=30.04.2024&em=8&code=LKOH&f=LKOH_200430_240430&cn=LKOH&market=undefined&yf={from_year}&yt={to_year}&df={from_day}&dt={to_day}&mf={from_month}&mt={to_month}&token=03AFcWeA5tVJSrcq3GQev5pYill6fGJ3TIYi7vbxi145HfIsb1Vl739VoVVftiOEXtmfkI8AWCfFCRbQBU7eddwVKr1er52S8C4d8MwA2YbO8WIBlYbXnm13KGGhId9BBKJQ_zw1uhnczj_b5_jqYh39TRUTGfnxtlVeUvQJw5XqMtwMc8hyHZExaUt4g_HKGpn1WwalS6p6dJK7k2VQYX_NWU5p6grdyBozQIK1Cwzq2MQ6I3mgeC0ltHzFCYxz3hOaKKE_QXpXrJoHiw8aAj_WTgh1z0Yw20A_VzR_2sQpS-QxSWS_1GqX49ahkEoHcEf-oqPV5ived7XomQku2bVIXfihJP9XjoLpWWP9ofJU6rVXSxY6uT3t7-OjCsjSwKiIeUYZfZpz2AkrY-xwwLeDqlGK5xbRXbKM-Y_teM-q_c1pzMAHIgx0ATzA2ZJ-MxLA5b35cSCI0efSpzANNa4XP7e7hJoTkddZ0KOT0GrFNc5x6r7z4i8JsG_JYKy_phSknZMnXlSn3L3QpjL3X1n3iNMPx2wVwii4UIk-Oou-CN60JAM_zyHXKUtrMv62UWFau6RzO4RnNDG3faKHAG4v--22xx7WdzKaImouRbB8NyFz8dDN4037wrbyzwHzrGs5ccwL6hbPBPqLcX4SQsL2at2C_iN5wsYg"
ASTR_daily_url = "https://export.finam.ru/export9.out?apply=0&p=8&e=.csv&dtf=2&tmf=1&MSOR=0&mstimever=on&sep=3&sep2=1&datf=1&at=1&from=30.04.2020&to=30.04.2024&em=4577624&code=ASTR&f=ASTR_200430_240430&cn=ASTR&market=undefined&yf={from_year}&yt={to_year}&df={from_day}&dt={to_day}&mf={from_month}&mt={to_month}&token=03AFcWeA6Lrq7hcRqeVRbWycqL86mZQo4dnYig9Frnfomix69hnURGk6FxJcydMa5THHpMVfWlKyq9fiAqmw4U__a-gdLlRsCTaryi4YrR4-T6-9AfWCkOqNx1866zDJRgXF0mCskJU7RPZxRUIq3JEnlqMrHOE2RM-g2h8tWqpx8LuWNdaagyuCg8H7KbqktVtmWMieKOJ7STcATWYdEA_McxIv1YbmgCCzw_ack6zu8_P1GXNHof3oD3vF8-PY5A7JHHnsrn7E_C3EX8v6dyEvvZ9XALz7TIihS-hJ0yHelphqxyPQ3XoT5SIprfOq53NjMGJs9LEuTLYb5rYWWB2H4oIpkj0n5B72mewVA_4tsRW_KeSRiHAm5gCh1DOwdvpSAJ_kBcKlGitZTRa7jhAz8gJG9I5pprE2TXbzif73vjxxjGGcwpAxi5NuP_8cMFSfFkk5-bV4UC-SSpM7w7DIk_xtKESRnF1QgqIZT_jH3CsjC9R8aOsSxvU2Wd3NsFf5BNAvBKiMRJZFsUbQ_c6QJEh4xpZ7MGHQZEyu-pVMQxi5wrCjaVZIhE6ibaHmqNVfkFgn0-cFTFTpV78iOIH6lIA3ZYx4Stqfr2AOnZp_TneEB46gwcq4Dggg_ucL1hMGrX7Q4i6kmOplQhERuHcecUbEDMXlkGRvp2noyuVkdfynlYxdAjCck"
GMKN_daily_url = "https://export.finam.ru/export9.out?apply=0&p=8&e=.csv&dtf=2&tmf=1&MSOR=0&mstimever=on&sep=3&sep2=1&datf=1&at=1&from=30.04.2020&to=30.04.2024&em=795&code=GMKN&f=GMKN_200430_240430&cn=GMKN&market=undefined&yf={from_year}&yt={to_year}&df={from_day}&dt={to_day}&mf={from_month}&mt={to_month}&token=03AFcWeA4R-RTy8ZFxN1JT9ZWeeLcV8PDyYuvtxPoz0lNHSoB5PQXwJ_ftK8nz2A2mlL-uNVtxvDEngZApy2bVm4Lq9mUN64kFbpVb5RdnTdHXgeEErVGjBdStCoyK_E0dU31R1831UqlvbzHRbv8_nF7O4vuH_T4rca9CvaXWxVizvKjy_z7Fb608TZu9cldK63LTlUrTSsuvrQtbTV8WtJ3BiyaU4QXiJO6nKXInq9hW4DyYt8uQUSp2kXXiVfJFSIlyqv4A42alPgRbKkZR8Jc7bS75qSgkBM5Xu2ys64F13XuYw5R7h-HI9QS20241LiivQN0tK2-0KFBjahx0G7RDyFMzDeiHO7gENSNduxQQXhwSxUZWTqw4R5FqG-SIAOnEnJSEPbq8dSZj39VMTOifqmki6sc-EsbVa7iuXKklRdmP4wrALKH_e4YpLFK2ryqB_l6haRInVv3xBoIWRerQIZHiqZDjIHZTJep3xbqfdAiq3BStxplkeegk44WmRi0IWvFCGFQoumlFq8XU9S7e6sGWgdoCrTbokKp4JalqGsMD53JWBMZCQh5yrRK466B3ZSRoi3ZprmgegmcFVzcv-3OtFOeAgkEGLiJ7aT-D82nrfCAsbbr6RWBich7kWnp4c6JQ_o6X2QVAcuk6YUXtBZmnXWtv8pkEqbTNWRjLPnytaw4tqMY"
MGNT_daily_url = "https://export.finam.ru/export9.out?apply=0&p=8&e=.csv&dtf=2&tmf=1&MSOR=0&mstimever=on&sep=3&sep2=1&datf=1&at=1&from=30.04.2020&to=30.04.2024&em=17086&code=MGNT&f=MGNT_200430_240430&cn=MGNT&market=undefined&yf={from_year}&yt={to_year}&df={from_day}&dt={to_day}&mf={from_month}&mt={to_month}&token=03AFcWeA6cGvBJEXSXsDlP40ASEZVEH9foQvJr95_P_xf-MikrW4Ppg1HScRspKPnnQnQRbFbNrp3Fwc1f5Cltae20luK1A6rl99QSGL17RVZCQhfnJcwBr-JlwHXiaezex5OIoAxGMRRrWVSskYuQwZYOquB9EnlZVIZsk2QO-B9FqlAnSPHld0hjTiMcFkZktfao-9mzYQfChuV8mCKwnwgitcwM2_owMcQZ-PuDGxcJ7uea3SeomtkNg-pZOd_B_equUYYWqmWQo6lNGcWfMroKbS2j15eg_vWtMaM9_zlqRO-Rxojn45qflAffAPrCt8_BaXSPvfswbwYfjLCnDGOEzzv5ntN4B4yPxiQl7kKoAKcpKZ2b6n0ENHpQhj2vYJPi-L-pLCPadFyomhrnrE7MXf8SY0aXAJej8yQb8NYA-B3JByWZvNBLBf8fUap1m9H9B8MZSH_w15fIZ_4JYnc5zKrZLJkwytUwBJ-5e71iNrz0b6BaXmu2uETUMWNZXbLEjDxk0jK6FTmYQVmjC21RxzClYqSqun5x4oakxziBk0azTdMADYrBkmBBZpVjkdAuirImofLc4gZfkzcyw8UulwOUV3r9WCXrrPrEmZS3yQKlXXzQE9CxN3boxJJmNsSvCOKiXdNHjp3j56vjZ_csTBBSppQ7xQ13bavtvKBKJ1xdtxJLscc"
PLZL_daily_url = "https://export.finam.ru/export9.out?apply=0&p=8&e=.csv&dtf=2&tmf=1&MSOR=0&mstimever=on&sep=3&sep2=1&datf=1&at=1&from=30.04.2020&to=30.04.2024&em=17123&code=PLZL&f=PLZL_200430_240430&cn=PLZL&market=undefined&yf={from_year}&yt={to_year}&df={from_day}&dt={to_day}&mf={from_month}&mt={to_month}&token=03AFcWeA7416CQ_YkSKxgqsAZbn6tfD2Q0ZhzSEGRws8luAvq30mkSGCszIi_4JheF4t72A8tbViE5jkPVtAOyblbWfG8Kic139N2g1YIZtmC2vJDQY20NEo-pDzeYYVj0o2lArEcMK-IAJ-Hq8lE5Y7UBpvZjyZOb5hc9HRk6J5C6w5ghI58upFIvYzEf1k3Kiu1OzEmx24qDHuQD4HYmvoHekQpjVP5k18ZxIfQwAERIvMbIPLl4J3DK3F1bzxYGDHo-x5GN8mS738j_vWyHq6G3hVayM8zU4wMT9gE6Q3pB2AFKrPY0OmBlgSu7NgkSrNSnIR_jbkSE2Oe4htKCCEqkFQkihXpmBQIha9Wa2RgoyPsWjiQUndk0E-njqz2hg0vs5aTVUEuw9KdJseE8ZdiMz9wlWx-gHRSTBrtvjf8sSaV6i8iex-kDnqV6MVNLsvdIk6nmP4NilRPZ56TxJ6eCDlsx3Jl8eKCZrvENk8ktNJyJiwT07pHISghJXYX2ZeM0zE7TeWhUPTH-fXxf3_e7jQwjmFxu3ND6WKctGQZCcJ8_0maomF4h9K4SEmq9eXmVqviPzi2I0Rl4fAfbBjmhgJr7WwxQmKwyqyH_MtYUhjJWnVc4XesuYVtvkrCO3_OcsF5hcnjPKkFjYjZP3e-JWYADCsrQYcwd4e5cgMph-wLSLxiXJMw"
GAZP_daily_url = "https://export.finam.ru/export9.out?apply=0&p=8&e=.csv&dtf=2&tmf=1&MSOR=0&mstimever=on&sep=3&sep2=1&datf=1&at=1&from=04.04.2023&to=30.04.2024&market=undefined&em=16842&code=GAZP&f=GAZP_220404_240430&cn=GAZP&yf={from_year}&yt={to_year}&df={from_day}&dt={to_day}&mf={from_month}&mt={to_month}&token=03AFcWeA5ddzp5UXkMvzLvH4P8ZL8M3Iee8zosxI8dAfmwgtc1gktVNgdhqo_VzgFWxpa88jOpj4ZDMQ2jOrrk1guF4EIh6yDpwumT2aadqpyNJiR7bqoWsGD_s58vpP-e_sfKdW9YPYVPeyhn4PH3VjmzcwaXX58dJz4exNhARBMBbBTs4zQ7DKTk6IFSclgmCDh-O4OByzMKG8Rq9bflwF906C75rVRJm4W4wzwHVY6Gb2mVfrhEt6WqcZyM2KvV5C9yVIJtxAVE_MFtVTJLg9acdEpJ7es87t8kDM11R0uZtbGL-52Fr2rIidpp3d5ij3RCs_pkGCNVrByfhum_JwxQ5pPd3F1ydn92_Afm_o1TUd8JN7e7R4oXcKeUHXoQJXrvb641lXAgdj-HuL0tlXVbJg0-R6mcrzj5UPKByZCUGTcsrjSyvLhJEec4GcVM-LmN9wTSvhBPs-Vs6vjQK5CvuGtxZE3kxWnOQk5wL0xR88efqujknmMNWbuFFzzzRNe9tzYde7XnfjqXxFfNvRZR1Re1gS321iWyQ1Rr_MiccCKfhZUAS-p_LtjPy1CobLHCTMVVOSbjcp-sX3BuynuBSSY5vB0IfrQe1bj46g_ec-jhyk0fGtl0JRyioc0tKDWSQ79tC8JcCenagrM2Xg7uGmpupyqipefbsq_r5-rZneXTAfonue03a1368iMJuzVCwTZY8ZIy3234wqwz-tJpxL26xIXhzw"
SBER_daily_url = "https://export.finam.ru/export9.out?apply=0&p=8&e=.csv&dtf=2&tmf=1&MSOR=0&mstimever=on&sep=3&sep2=1&datf=1&at=1&from=04.04.2022&to=30.04.2024&em=3&code=SBER&f=SBER_220404_240430&cn=SBER&market=undefined&yf={from_year}&yt={to_year}&df={from_day}&dt={to_day}&mf={from_month}&mt={to_month}&token=03AFcWeA4M6d4d7bTNL8Xyl-p6Uqi2b7UKwzys9lXJYRAqvq_EOnVEJGDSAHIPjkCRoorWCYYb0NAWGMsThASHVHFnEyIfaeiQueRRrzpf2xOhExmhIrEAXUiRVVNWy4-Zm_gvaD0G0xxeRSuLQfzf1w4C1tps710yB425G3r9FrYVGy4BQExGpTri5JOySteEbJMwnBOZoPYKbB32UdbcaN_NfCInoks502CW8uzt_2OU-CyV1lfo3tWl2rugb215qY7phH18vTrFIPErnn9wyutKj-lixMyHONVZpcUkLzbvlrjPkW2n9bDwTrBtudmviqWeT9vSjxpW_odZamg1cILVNq7Xx6A_tan95nSru9ZJ62TTihrq1_im4aj1DI_EM6GudX4BNIa1fRuqQH3NDCFnwQ7Ph7A9nnHyWb3CJdGWyO-hXCqabFZC95ZiUdlMTC_YhS0oNX47oSFp65g544sImUz_g3-19oWOmdbXa5ySmW6x5lNwHDyIcWzjVV5wbWIm7-twgBM033okI3FeuSmph6Upnj-uV0EpWGuqOlVMY0jqyiZEsmfp3cKcX_LgWq3XnIF4--cBvuhO4sz5za1ynWzucn3nwElMKgGBd67RxnyWeoYdTme7MEEcI7ZFN_J6DeDzOxleHk9pYvhev-_ZZPx8xW96Lg"
NVTK_daily_url = "https://export.finam.ru/export9.out?apply=0&p=8&e=.csv&dtf=2&tmf=1&MSOR=0&mstimever=on&sep=3&sep2=1&datf=1&at=1&from=30.04.2020&to=30.04.2024&em=17370&code=NVTK&f=NVTK_200430_240430&cn=NVTK&market=undefined&yf={from_year}&yt={to_year}&df={from_day}&dt={to_day}&mf={from_month}&mt={to_month}&token=03AFcWeA5IKQMPiua_8PMdwsswQTQ50A_crR3fK1Ik1jguwviS0pwUU-dxd4A646jsCyRjG_4FWYVdiZ_tVstu6MVO_2QcrLz4fpAJ-HU2fpcCPhl_G3kfwl-GxIkJqfX6T53yAnsxau0KANeeK2hLAQh347gprg71dkvHRulGkfZUB89B3LIGhNDA7BcDRM1GikWcLh1XPOE52wvuOZfTUor_Ap-5PmIEVS-xQtdqkCAHre7fXseXlu5XW4FBpzRcaeNrZkNU6I9nVwdtJCj_b4PEPXgcgQiCXJUwFW5paFoL65oyeHZtHx6edJxEMHtdXA6pxt8Bn9FZbbaumAxwdubpV5NW4MPVOjhmGtweFMkdxHHKz_hRlacOhdVHrPRkmHJmLodcP1q0OVtAd-QyE6SZ1-8oJVjT8mbpDTEpS3-OnsvI42AMc5Ctd9f992tCpgD2aiaUgGB2S0uyibR1UXzJhDE9rcNVADnn9WZR7BZp3aquRSbY0OKLF00sZvvrY_pG9lbdsqdQjFXqbwmUVXoFpdVP-dfk-jayJRQDZhmAte7VB_KJRXcuRJZyrEKjUN9lc07BjpnFJoX0k_UG5KlDpFu3GsqWC2QDSO-NaBZUEe0eqqRLDkmUOjhH1Dk8KoobZBS60r194jc-ovPu1tD3153y7OYSGXcF4e53KKb_7ziHs3uNXV8"
YNDX_daily_url = "https://export.finam.ru/export9.out?apply=0&p=8&e=.csv&dtf=2&tmf=1&MSOR=0&mstimever=on&sep=3&sep2=1&datf=1&at=1&from=01.01.2024&to=01.04.2024&em=388383&code=YNDX&f=YNDX_240101_240401&cn=YNDX&market=undefined&yf={from_year}&yt={to_year}&df={from_day}&dt={to_day}&mf={from_month}&mt={to_month}&token=03AFcWeA7hC1lQ5UKdYAOhkH5EM3sVRprq4vt8d49s95M1RuPV-m52l9cqWHy4-pNqjWwag20VNy0_TRBmtEDbz-6J3EzQLfFebuV6Gs6Lx7Fuepdr93Fi3NXIwZ8cjzm2rMDTr20aQNEp6NmFsNArXW86a9EFTlHkCIzjnrxkz1id1YF1yT_ybV0KJoIK-g--M2yrVQRZDRsl7bwibzivIWP4p1T-91Q5ppAGJQQEtfSPag2iivUMRJkoj_6vcO3JraEfRjdRC-BGilCuoDdUn33w9rjnfqXY1PULRbFd_eWLNLyXuBsIQOBtAmtyTfhFdQt6FW5s-QnHaWtrg5YqtGdH3gI8isDGkKaGF9h8VshjRkT5Ou5uhVspKUBzi_oOIas2q4ROWSlhwT3UMWzbp6jgpTe9grJ6uVI-FMTYD_FtBAydH-JfswiWAbGE2vYvQ0EyIP3IS4HVJKuxTzFdfLKxDPx5x4SnsEAf89cox7cXhaotPfuePZNBCBQjCCQRgZbua3z-OarRiQkzqyx2aXtnuvJXyhwGZ22i8TaoCjMAswsxhocdTW_OfE-xEAjoqBegFHqAq2i2ewki269vf-6vWB2HFpr4ffZcI5J-wSy0mHGU3BVUtilzaha4hGud0kWFnYH7vuSFrqn2szmmw7QUVRHQBw22h-hMFqkHWdFuHfRQH08B8K1aGN8wiuGnnfVX7bkPZY5x"

VTBR_hourly_url = "https://export.finam.ru/export9.out?apply=0&p=7&e=.csv&dtf=2&tmf=1&MSOR=0&mstimever=on&sep=3&sep2=1&datf=1&at=1&from=01.01.2024&to=01.04.2024&em=16842&code=GAZP&f=GAZP_240101_240401&cn=GAZP&market=undefined&yf={from_year}&yt={to_year}&df={from_day}&dt={to_day}&mf={from_month}&mt={to_month}&token=03AFcWeA6XAT91nch6iBwQ3q8XX0zutx676yVogaMSjkUoJTMy5LEVxiHuQsak_MoqoH4FVGbICcV0HQXpxPGV4pESf9YtK8oBWxW9J3Q_8vx_oTj9_V_j_W3T5kYQDtJN4YzYfZatidjecDItfXhlue9O2xnun3OUI3hK3bNzCEZBCydVYkLhFZMGtcEXBwQcd7WMTJTIGNPBsCV3g3JzmDPVEcR2yvpQEsBjp85Ztn2hMQGjvoQm72UyftMJefoIXXcTKZhRjiM2y34_MmtGngjB_BSMj8rLamTyWgQwNHThRV3vSgCs9vMkpmybroL3T8nt1jT1uR3RO41U0HL5rPyHIhwgcfx4SIHTwmutGifh3h8hPwkIs1RUMnw8NZcTfMxoRyZgpqKIcs_kPKIm-wXOL2JoR5KEy_dJl30tz1AWtMI297uPfm7snQAxgUcP06VLA5OVJBZzuJMWL1NJ0Hc-k6TEkgCOy2wm8Da-ZyiVcjsYSZyqc5kVNYtbBmICz17OUqILX7sQlCDUNtPlRsIQyRguCo4JyntEl_Yn8zrjiFXGOv-GUHq-HH8QOeY3IzEM7UK4B0CzjfxMVK4co0QjzjfI6VLSEa8GCVQY1XQ21B4VzfMGaZYimczwSmifFw6C-zt8C3zf4YtMAFfKOd5t7PHPDLbfzX5jyrLg9mu6TmPfPs7QG9c"
LKOH_hourly_url = "https://export.finam.ru/export9.out?apply=0&p=7&e=.csv&dtf=2&tmf=1&MSOR=0&mstimever=on&sep=3&sep2=1&datf=1&at=1&from=01.01.2024&to=01.04.2024&em=16842&code=GAZP&f=GAZP_240101_240401&cn=GAZP&market=undefined&yf={from_year}&yt={to_year}&df={from_day}&dt={to_day}&mf={from_month}&mt={to_month}&token=03AFcWeA6uDWbSVCnljwL00g9oxHIo6NY_yacLwsdyJzg2Y_l4lf_7yH_idbprea3Osq95B3TUaN644wel6DzmYBAUKztX2snkR8YRsO7pWGJyH8AxxjPxKQ5Uf0144dm75D2mw8ypQJe6VW8XLLUZpYOEQ4i6S3faYR9U9gNJ64CTaQkH3tjwX5jV-EycWhzMpyR-Up_fx-I3gAud6EZDvWfoV3pP4pDVkosNrevC1R23SFGc7KZMU8I2RY5lMsT5fA7zkafnY5ZUPuNdToQy4XsgxHE27R3mNiufP6kLfCCwJ3f22iTsmNLDkhNELC6oyMAfjhb2yS-Ly19vNQ8VrjH9dGnnbUk1lC-3R-gjjiB7fGeilCdkF4lQlJWareuSzRijHHEiIc1JxSkzTuzHuclBbBlrMJdkAgGFMP_rHtPcJT6veXHoxRPaJPDPry9qiZKWRpt82oOqdAW44NvmA6-S23Kyl3kR6Dbb_Safs_SnM4wI_6glzz3Zp3iIo8QAl3cEYZJ0sJn48yHJbBoP3xbE3bNKD5ECM30C8FSPJQWQV9Q58I-A4i9KUDKVt0cMWz6ysx3GXSyQwLqhBiNEN03L5tOQEpGoyLN-IdyEIEiGBfJ8ap-7ZW2vlM1P3oSVXR9PTnEu3NmxIcIKYxFGJYKwZ0ABHCjc9dpTiEpquYsUnVcAoqZErPs"
ASTR_hourly_url = "https://export.finam.ru/export9.out?apply=0&p=7&e=.csv&dtf=2&tmf=1&MSOR=0&mstimever=on&sep=3&sep2=1&datf=1&at=1&from=01.01.2024&to=01.04.2024&em=4577624&code=ASTR&f=ASTR_240101_240401&cn=ASTR&market=undefined&yf={from_year}&yt={to_year}&df={from_day}&dt={to_day}&mf={from_month}&mt={to_month}&token=03AFcWeA4LR1YYSCVZnj7RDq5FMryzQBGRpwqj73q57R3C2RJ1PnDhpSnzTOSGpufBnX9ZNeYtMtOzYUagBPtuWpkdMPl_SmFpR9Lid6W2p7YAsReqA3TLwSbmGjAgvnmiynlR2HM1LgtKT_jV0Mnn6KDBA9OGfwYzIjg67SLYjCB_nRY8GDSlD_s-0VFF_4jEFMEPPcImW66yf_MD_mduVVZKAcYvOQ-ATgKdU1YTVumsIvrqdUKpWTyx3Cxp_dQkq-wfO9tZqx_YNs5JU1uSxzIBgLCQNVuiQoNweW7vZofUU2i0yL_q7rKvIM4iujrRAqQiU_AO-22farMbuydKBAhQwwprj04lg1NaTLZWqufdCmUZP1i1u_LejOlCmCItOWBw1rRP6Kxqb9WG0vJrXoy_Djpn97OJBqY-Ka9nE7l_lJvKUJaD_8dNEomEnIY0SdFMB9f924ORcrC9Oe-Soll2x330AU0RzE8Ch3Ma01WELjTzZbk0WfiKAdt0iEK0IqFbjcN-CwKCR0iStddPwBy5NriQ3l7pK56ZxMCxOKIB4kII1DStfP47GIhCgcf4yC8f3C88xkUs4HnH1ebE_nHVVPBtI-Ocqa9rnen7gci3lX9_laKkLQ3tLBkvDktp4YZEl5TLbJJfNUAuvI20lGmv4i3CCWl8HGoMqbGme1vo5nfDbj2_GWE"
GMKN_hourly_url = "https://export.finam.ru/export9.out?apply=0&p=7&e=.csv&dtf=2&tmf=1&MSOR=0&mstimever=on&sep=3&sep2=1&datf=1&at=1&from=01.01.2024&to=01.04.2024&em=795&code=GMKN&f=GMKN_240101_240401&cn=GMKN&market=undefined&&yf={from_year}&yt={to_year}&df={from_day}&dt={to_day}&mf={from_month}&mt={to_month}&token=03AFcWeA4IHLuxvcbwLZgYC3aDiPdWgbI4kSGHavYL2lC_LD1drZQ95TWyXvTMRGnVoyQjJirR2T11ST1fZvFaIhCphUhRqMIJYxHeLgqS9q9uy-B6BstWVC-Q0ofT9q0-Qs8NQxiC-4PV8I7MVBKxjfsCFk1PC3D1XjS1ucy2Ckjyl2FXenurZYs9mXh1o3lfCUOoDcyH8I3281st6rZPSFxG440MTgMf30MWZQVp_o2ff_0nGBuzmMOvsjASuDn38yXPX9FSOPR8umou0k8C7sPNVwWWS9IlBVCHfkfhnaMoKyZIdposELcBGHcqCq4w1no-2_JGU0oJlJRhLtCS0AlluZN3w_SB-UjrYM1Aoha1bg-y_aDwWjhhLsUgCDssPDkAdxvSzQm5aISOKn1HmneYV8CQPlJf1kRvhaHdAhNJhRY9o4e_diyphxlLxVfUoaW26iVR40voaQD3QYmrYKlYTZE4DluWqfQduw5_mtr3MiGxK93qbiGche0oxZnNrnasoDpu9ZPnRp22C_WsyEqmZ2pIyedQjPhVlUf92cyVcDO-PlFz7oseS-FthMSu7iazhp3eRVM-h58m8ELgRD7HGduCKZJ7tbtrI92pZzc96b9KXMXh_t-w0coCWoJvX5LBvnjuDkEgyMPzTMeC2swl2hZCnj9F_4Jj3UEqB6jKGiwHTTwbd4E"
MGNT_hourly_url = "https://export.finam.ru/export9.out?apply=0&p=7&e=.csv&dtf=2&tmf=1&MSOR=0&mstimever=on&sep=3&sep2=1&datf=1&at=1&from=01.01.2024&to=01.04.2024&em=17086&code=MGNT&f=MGNT_240101_240401&cn=MGNT&market=undefined&yf={from_year}&yt={to_year}&df={from_day}&dt={to_day}&mf={from_month}&mt={to_month}&token=03AFcWeA6HdE1wFf3-WOtEJAwL-jx6kp7qZvTqRP_nHBnQ-pyE2acc02Ax6xrKSjKo38PxxwumdpK10PBnxFRA_-fVSEB-uS1Q6ID_MaAYgnum-18iEzl8XWuYF1n6XJ9b5Kvaeq2acUFGKevc7EsgrvNRucIhkqCEGKCFj_FTjcbOeW_zoxJk-aZQqUq-UyPGLafoWu5k07iXtd7e2vTEmV2tUE3he_GI8U3A1v3YgHC5egGHkZm9oFNMOFO8CHdGzusDWo20REPct4iZF0ySBlUXJrONAlMjPbDfacbWA6qsHjYK2RJyy62kh2YkN1OtEHPrZ_r0DFISWPSLavG43jvqsTm62hHtlTh75yWMLNfwGK_D_fgvmLW6qHwACDaf9LCMWGog4qSLpPh5oc8FFmA6ffSEiranit3zpbM44Pf-dYe9aQmIPbNzHKUpFlm6hG6_wp0FduGMLTKqgjn_6-1mGJ3pYwhOYrgRt1UW4k-zWKo7LT4kri2ij5-EmUBXwNts_ky1JL-iPi54WVN50UYbqaWOPT9rmI_wuNnKhOBvi1JXkDcLac3j8TiGzXo8kptgh7mx2Q_DCC7Y2Jthm0_G6kjgxb_1ei1KNJEk2izDJFcaDLtslwu9cONFrLufBp3YSYJYvr9Rhp28oQy8YDDZPbZXpaXj45JR7tOWd0ET_e8K0y6Y3Lw"
PLZL_hourly_url = "https://export.finam.ru/export9.out?apply=0&p=7&e=.csv&dtf=2&tmf=1&MSOR=0&mstimever=on&sep=3&sep2=1&datf=1&at=1&from=01.01.2024&to=01.04.2024&em=17123&code=PLZL&f=PLZL_240101_240401&cn=PLZL&market=undefined&yf={from_year}&yt={to_year}&df={from_day}&dt={to_day}&mf={from_month}&mt={to_month}&token=03AFcWeA6jgf_fjeTOApVnnNTv8kuDKYo-muClYiKitB-KlahKNVPRE4VcubiunSSXJkMYLwkwctYBf6CW8oqJGELnDTIjPHfL8-HDWfu0TuH8MxwrprBEnrRSsVjAeEMuV00uVqFon93nF4_-Ti6DaC8bv9xvmV1Au5mCk4mXxictXp8CHyk0SbqnioeSAQB4rS1mgoquYuAry-KQi1wvmRGTjuWRsEy-YpUHoRmPMfDR9WTyFDT4FOD14CV_m1XZ3Ivg0wE5xLE3zfxUVR4kgjhT7ArQbwpMVniPn7dJSkmIHorD3fKoTr8ZFs6p9gx9FruFmHoiP2VY6oDtyEsAPb9gL6OpOKiPic0TRyDP2MAjuc2WbHQmocGavqWwaifxdhNNaA82j7I_hYf62mZPLNpxy0E51fYeG5p7rDMK0Yt2ZGNDihZNs11JOAaISYiRukrSHgAmWcyLVqy1D1DTIyPKsZQEZLye2zEEeZD2kySdVqiqos4-_TOnJ92Eok9k9ZVvPNArXPxUUagBBIU6B2kYVerpQRw_Og1t02CldvfJuAdmWHvmq7o1_y0MM8T2wLKyZmAcAGpFDq0EcHV7hBeRwIp0kFwKE4yWZ0aGXadOQM2sAwlA6zzY7zZax87-Cd1JxQ5GcDJlyQi5tkT8v7W9zJINaGRop1u3I-MObqpR-7-8-YLYHTU"
GAZP_hourly_url = "https://export.finam.ru/export9.out?apply=0&p=7&e=.csv&dtf=2&tmf=1&MSOR=0&mstimever=on&sep=3&sep2=1&datf=1&at=1&from=01.01.2024&to=01.04.2024&em=16842&code=GAZP&f=GAZP_240101_240401&cn=GAZP&market=undefined&yf={from_year}&yt={to_year}&df={from_day}&dt={to_day}&mf={from_month}&mt={to_month}&token=03AFcWeA5weUbt0FonWewWXOMAJvFMn7uQ4LHZtgspLMpmkbJI8XLer7bx7TQgR3_cmwBUp1nsRKsU_dWPexmRn03ATyJCLgVBuA2KhF2rKhxcKJEWUOh7ajd5ycMXM2tOvXasUIm8jIlKgz0yh0AxZN5BXN9uh5ZWcn-qnSn_zMiZPI68FxyQkqQWwEE2n1kIjvFbDbqzWTPENoq9OqYBcuG042MNQwenlKWGlrwQh2Jsm7kwAhkSPMdSgaI6kmFeUYnjU9mLHrXTB5Ygo8hmi8IZeTBcIeogOKIuR3nFii1fHNIbuq2GHlQELMX77zd4Ty79kW_uvJfzCFCVGZFz4VwSdAlweRY-yLRI5MHLpnGU03QtnfP7IZe7OE-VCcIBBgnBLxQfa6nEKhFxo9PU9khyrMnLklRcxAPN1b_3uDfVg2KfAlugA7f5FJMkwU1Z_HFkw5IuxIsl5U04S2D4aby9V00_ZZQs9YiUYjAx7dDT8lDiDpRSK1vw-lw88TLLixSyEPcbTHqCkRot3IjmlvxuJGjmjOUuTN9rjUQxmK8YdCS2yrbzUYwjOG7i2F5ziSQL8CabY6JK1ShDsDqp4wzWvwdozGT9yxeDgvQEtsd5IpFq3p4zKHXujxVp7fZ4hRQcJUHm6Ge6I3RHJN66czRSJxkojS0c5seXnvRg2_OVzmkjnNyw3NQ"
SBER_hourly_url = "https://export.finam.ru/export9.out?apply=0&p=7&e=.csv&dtf=2&tmf=1&MSOR=0&mstimever=on&sep=3&sep2=1&datf=1&at=1&from=01.01.2024&to=01.04.2024&em=3&code=SBER&f=SBER_240101_240401&cn=SBER&market=undefined&yf={from_year}&yt={to_year}&df={from_day}&dt={to_day}&mf={from_month}&mt={to_month}&token=03AFcWeA7A_xTgKM7o-NSSfI3cUe7TSQNMxjMAFDA8I7_PTBdYeZ3ZIlerYXTOC4KNSR8lDMuT8ZbfiGUXHcNd6wA1XgGo5SBf5-uq94E4J0UYWLfM0SXipKSQ6VpSrrOW6dA4B8CQ5MvRcTGmDhOUFtfGN8GmRtry8nb1C1Ti915KCmiAH2LCNHeuWiNYJQ0zM2nCh40ws9Q-AZRKf9pKKkL93C5OXNyWnpODAsLqizmoMKO03EDIp_qSJcDZYmkWo3cNNYlMlglr-Z0xqk9l0HCSFGWACxAkeNV4qlI9BHZ_MZIlZcLgA9rpAL54n7cUqMvt_5iEJ4xY3t16v8qC5-S8mbtuj8UaT6c23Et2Z0Wa9RBhFUduim44moPn7EyBFw4dlc8niV6mS-nu_8k8k4tnjzU2UnDZngEMuMP3MTdVDAPurdcdLH56cXETEENCRJVPD4cjkGbDZtvqvrKqnQ4FS9pB8zeiPoLn6XM4VSRlYe-eLz3YAGcvSbt6rFZRGBcDwM8-hRzAQjrKR1y-FEiDQA496dWnzsF3GrQRXRVPgoPNUcbX6lwcr4XSwWrDcH2JDqsbFqzbdlWlrl3UgePcG2wo0rfKPQ-vPu-C-QNX-6Nz8yJvGXIT9-UkLATpjX01gIDSKLu1Vd6009hQeu9jkfMW6XgGpF2bsDTPyVSsNgaVxzjUerU"
NVTK_hourly_url = "https://export.finam.ru/export9.out?apply=0&p=7&e=.csv&dtf=2&tmf=1&MSOR=0&mstimever=on&sep=3&sep2=1&datf=1&at=1&from=01.01.2024&to=01.04.2024&em=17370&code=NVTK&f=NVTK_240101_240401&cn=NVTK&market=undefined&yf={from_year}&yt={to_year}&df={from_day}&dt={to_day}&mf={from_month}&mt={to_month}&token=03AFcWeA5oOYc6WGZBC_9snUiIrfRJrs5fupy1BDis9cgLVLfFbk78kaBEjT6jQn-PibUZqi21QSQQISP5hEGWNHtQ-e-kMmfnxigQtFWOfw3KHbzXFF3TpTiB1YgsINGufQesFFVpQwyi6BZIsLLwcmOvXgIVMEH7ec7Z6FFxy05iNXOnlFk4_IminkOJureu9HMHxzagggtF0J-lPX_Td8p_40xdcRRlGOan3oPNoG-kppagN4HO5eMQM8840v-LQqbqvpTbEn7fenRtwsQvf_tcJ-MCqFAtgIsUMJOfR62VCrJeCUJvZoojOwpvXg1CvCxYwHqkTEWJ0CwSoBfRVtyoC9eIQGoHOJOspZT2nVrVZGIyoRmqSH8lp7eIMyeJQD-OgoJVxyyu0cZU5ViiF2VJnv5VOdSaDdvRxX8O7VgjLHTYDA61UQyibbmdd65HpzAvrJuNdzdcvMZP7bBTZYy5q3SWs6Uh2NxnWY9neR8l8adGcFhf-xYmIsmWGYyl26DqXlKzLO0sR6dBAKkwpaARP008ubLeBDLcmUkVs0NGwCAEYPgvjBm1VITsfHlnDLeFyhEfHZGD5BF0I_uXxyGe7YVTJbMSPl-1KOQSQMNDcNhHSBhQhUc6hX0eklCm7pHn1tuzLMYss3RFlBmDA_47MAJhqHnPVYF6OataFe4HU8v5aFQ8gF0"
YNDX_hourly_url = "https://export.finam.ru/export9.out?apply=0&p=7&e=.csv&dtf=2&tmf=1&MSOR=0&mstimever=on&sep=3&sep2=1&datf=1&at=1&from=01.01.2024&to=01.04.2024&em=388383&code=YNDX&f=YNDX_240101_240401&cn=YNDX&market=undefined&yf={from_year}&yt={to_year}&df={from_day}&dt={to_day}&mf={from_month}&mt={to_month}&token=03AFcWeA4_Ghz7-l1TnvS639JYf2AdI16okmHXh9AmLkc5Wxcojiufw7lrGMPjqlj5sBtDGuqEb3CBU05xsLb5xVPBOTKHrivrm0Zm37Mi2cUtetAQOZt4zz-MORmMg3zy1ndIUtCxCHjYkoAjisIZZk2Bmct-9_gEt65VvANR59jorpbMjYPfzCumgjegdBhjYBq56Sukud2piW52IuRxoybffvpy4PF6XSs4ht0lUe-yVaDJESOyAPI7GXShUTnOyTq0V0yBfjqlmNevirj6tAiJGYXGWP9iXv2XqlO8Ju3aV4o4bbuKy5fbqtOOS6tiWlLRw8vTC6eS3uA9mxdIQz9_ZN92wM3NSBBa44wIMbqkbN9wkOg32Gk6eloTOvucPaLjUvo342ZdDrElA_ZU0K0ESp63pEo8u1V0Ia8K4nRjN22Eog26vuRaQcBc4WI6h_752Ud3pTPUIoAPg-w-34qyHeOxpo9PbGA3Imj9ZnAjGdd718rQyTonusIXBAtq4GrgAxG9LfBQCiLiLKYwNLEd5fH0hQwEAqwJj5I_RKFX6qgVll3twx1Izd7r0Dv3IF1iHeJhkMnKi0P94TSDdYQgE9KlcHOSD4JSEL-J5m51DGpo6mar4aYRku0Mkio72KpYNIGlzEy1My-Et8RNDx_kB3i30ZDY_9C4wAnzueutQmjBhe79i2FaG9QTIKPkN9nLDUpNv-8X"

ru_tickers = ["VTBR", "LKOH", "ASTR", "GMKN", "MGNT", "PLZL", "GAZP", "SBER", "NVTK", "YNDX"]
ticker_dict = {"VTBR": {"1h": VTBR_hourly_url, "1d" : VTBR_daily_url, "1mo": VTBR_monthly_url},
               "LKOH": {"1h": LKOH_hourly_url, "1d" : LKOH_daily_url, "1mo": LKOH_monthly_url},
               "ASTR": {"1h": ASTR_hourly_url, "1d" : ASTR_daily_url, "1mo": ASTR_monthly_url},
               "GMKN": {"1h": GMKN_hourly_url, "1d" : GMKN_daily_url, "1mo": GMKN_monthly_url},
               "MGNT": {"1h": MGNT_hourly_url, "1d" : MGNT_daily_url, "1mo": MGNT_monthly_url},
               "PLZL": {"1h": PLZL_hourly_url, "1d" : PLZL_daily_url, "1mo": PLZL_monthly_url},
               "GAZP": {"1h": GAZP_hourly_url, "1d" : GAZP_daily_url, "1mo": GAZP_monthly_url},
               "SBER": {"1h": SBER_hourly_url, "1d" : SBER_daily_url, "1mo": SBER_monthly_url},
               "NVTK": {"1h": NVTK_hourly_url, "1d" : NVTK_daily_url, "1mo": NVTK_monthly_url},
               "YNDX": {"1h": YNDX_hourly_url, "1d" : YNDX_daily_url, "1mo": YNDX_monthly_url}}


def get_link(url, from_year, from_month, from_day, to_year, to_month, to_day):
    return url.format(url, from_year=from_year, to_year=to_year, from_day=from_day, to_day=to_day,
                      from_month=from_month, to_month=to_month)


def get_iss_historical_data(ticker, url,
                            from_year, from_month, from_day,
                            to_year, to_month, to_day,):
    r = requests.get(get_link(url, from_year, from_month, from_day, to_year, to_month, to_day))

    with open(f"{ticker}.csv", 'wb') as f:
        for chunk in r.iter_content():
            f.write(chunk)


def get_ru_ticker_info(ticker, date_from, date_to, interval):
    date_from_object = datetime.strptime(date_from, "%Y-%m-%d")
    date_to_object = datetime.strptime(date_to, "%Y-%m-%d")

    get_iss_historical_data(ticker, ticker_dict[ticker][interval],
                            date_from_object.year, date_from_object.month - 1, date_from_object.day,
                            date_to_object.year, date_to_object.month - 1, date_to_object.day)

    df = pd.read_csv(f'{ticker}.csv', sep=';')

    df["<DATE>"] = df["<DATE>"].astype(str) + " " + df["<TIME>"].astype(str)

    if (interval == "1h"):
        df["<DATE>"] = pd.to_datetime(df["<DATE>"], format='%y%m%d %H%M%S')
    else:
        df["<DATE>"] = pd.to_datetime(df["<DATE>"], format='%y%m%d %H')

    df = df.drop({'<PER>', '<TIME>'}, axis=1)

    df = df.rename(columns={'<CLOSE>': 'Close',
                            '<HIGH>': 'High',
                            '<LOW>': 'Low',
                            '<OPEN>': 'Open',
                            '<VOL>': 'Volume',
                            '<TICKER>': 'Symbol',
                            '<DATE>': 'Date'})
    df['Adj Close'] = df['Close']

    df = df.set_index('Date')

    return df



